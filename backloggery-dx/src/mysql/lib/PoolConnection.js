var inherits=require("util").inherits,Connection=require("./Connection"),Events=require("events");function PoolConnection(o,n){Connection.call(this,n),this._pool=o,Events.usingDomains&&(this.domain=o.domain),this.on("end",this._removeFromPool),this.on("error",(function(o){o.fatal&&this._removeFromPool()}))}module.exports=PoolConnection,inherits(PoolConnection,Connection),PoolConnection.prototype.release=function(){var o=this._pool;if(o&&!o._closed)return o.releaseConnection(this)},PoolConnection.prototype._realEnd=Connection.prototype.end,PoolConnection.prototype.end=function(){console.warn("Calling conn.end() to release a pooled connection is deprecated. In next version calling conn.end() will be restored to default conn.end() behavior. Use conn.release() instead."),this.release()},PoolConnection.prototype.destroy=function(){Connection.prototype.destroy.apply(this,arguments),this._removeFromPool(this)},PoolConnection.prototype._removeFromPool=function(){if(this._pool&&!this._pool._closed){var o=this._pool;this._pool=null,o._purgeConnection(this)}};